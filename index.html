<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kiosco con Carrito Avanzado</title>
    <link rel="stylesheet" href="styles.css"> 
</head>
<body>

    <header class="encabezado-kiosco">
        <h1>Mi Kiosco üç¨üç´ü•§</h1>
        <div class="resumen-carrito">
            <div class="carrito-info">
                <span>üõí Art√≠culos: <span id="contador-carrito">0</span></span>
                <span>üí∞ Total: <span id="total-carrito">0.00$</span></span> 
            </div>
            <button id="btn-vaciar" class="boton-quitar-todo">Vaciar Carrito</button>
        </div>
    </header>

    <main class="contenedor-principal">
        
        <section class="contenedor-productos">
            <div class="producto" data-id="1">
                <img src="imagen-snack.jpg" alt="Snack Salado">
                <h2>Snack Salado</h2>
                <p class="precio">1.50$</p> 
                <button class="boton-agregar" data-id="1" data-precio="1.50" data-nombre="Snack Salado">Agregar</button>
            </div>

            <div class="producto" data-id="2">
                <img src="imagen-refresco.jpg" alt="Bebida Refrescante">
                <h2>Refresco Grande</h2>
                <p class="precio">2.00$</p> 
                <button class="boton-agregar" data-id="2" data-precio="2.00" data-nombre="Refresco Grande">Agregar</button>
            </div>
            
            <div class="producto" data-id="3">
                <img src="imagen-chocolate.jpg" alt="Barra de Chocolate">
                <h2>Barra de Chocolate</h2>
                <p class="precio">1.25$</p> 
                <button class="boton-agregar" data-id="3" data-precio="1.25" data-nombre="Barra de Chocolate">Agregar</button>
            </div>
            
             <div class="producto" data-id="4">
                <img src="imagen-chicles.jpg" alt="Chicles Menta">
                <h2>Chicles Menta</h2>
                <p class="precio">0.75$</p> 
                <button class="boton-agregar" data-id="4" data-precio="0.75" data-nombre="Chicles Menta">Agregar</button>
            </div>
            
        </section>

        <aside class="carrito-detalle">
            <h2>Detalle del Pedido</h2>
            <div id="items-en-carrito">
                <p class="carrito-vacio">El carrito est√° vac√≠o. ¬°Agrega productos!</p>
            </div>
        </aside>

    </main>

    <footer class="pie-pagina">
        <p>&copy; 2025 Kiosco con JS Avanzado. Todos los derechos reservados.</p>
    </footer>

<script>
    // ----------------------------------------------------------------------------------
    // JAVASCRIPT: L√≥gica para AGREGAR y QUITAR productos sin mezclarlos
    // ----------------------------------------------------------------------------------

    // El array que contiene los objetos del carrito: [{id: 1, nombre: 'Snack Salado', precio: 1.50, cantidad: 2}]
    let carrito = [];
    // Nuevo: Definimos el s√≠mbolo de moneda para usarlo en el DOM
    const MONEDA = '$'; 

    // Elementos del DOM (Document Object Model)
    const totalElement = document.getElementById('total-carrito');
    const contadorElement = document.getElementById('contador-carrito');
    const itemsEnCarritoElement = document.getElementById('items-en-carrito');
    const botonesAgregar = document.querySelectorAll('.boton-agregar');
    const btnVaciar = document.getElementById('btn-vaciar');

    // ----------------------------------------------------
    // FUNCIONES PRINCIPALES
    // ----------------------------------------------------

    /** Dibuja la lista detallada y actualiza los totales. */
    function actualizarCarritoDOM() {
        let total = 0;
        let contador = 0;
        itemsEnCarritoElement.innerHTML = ''; // Limpiar la lista actual

        if (carrito.length === 0) {
            itemsEnCarritoElement.innerHTML = '<p class="carrito-vacio">El carrito est√° vac√≠o. ¬°Agrega productos!</p>';
            // CAMBIO AQU√ç: Uso de MONEDA
            totalElement.textContent = '0.00' + MONEDA; 
            contadorElement.textContent = '0';
            return;
        }

        carrito.forEach(item => {
            // C√°lculo de totales
            const subtotal = item.precio * item.cantidad;
            total += subtotal;
            contador += item.cantidad;

            // Creaci√≥n del HTML para el detalle del producto en la barra lateral
            const itemHTML = `
                <div class="item-carrito">
                    <div class="item-info">
                        ${item.nombre} <br>
                        <span>${item.cantidad} x ${item.precio.toFixed(2)}${MONEDA}</span> 
                    </div>
                    <button class="btn-quitar-item" data-id="${item.id}">- Quitar</button>
                </div>
            `;
            itemsEnCarritoElement.innerHTML += itemHTML;
        });

        // Actualizar los totales del encabezado
        // CAMBIO AQU√ç: Uso de MONEDA
        totalElement.textContent = total.toFixed(2) + MONEDA; 
        contadorElement.textContent = contador;
        
        // Asignar el listener a los nuevos botones de Quitar (que se acaban de crear)
        asignarListenersQuitar();
    }

    /** L√≥gica para AGREGAR un producto */
    function agregarProducto(id, nombre, precio) {
        // Buscar si el producto ya existe en el carrito
        const itemExistente = carrito.find(item => item.id == id);

        if (itemExistente) {
            // Si existe, incrementamos solo la cantidad
            itemExistente.cantidad += 1;
        } else {
            // Si no existe, lo agregamos como nuevo
            carrito.push({
                id: id,
                nombre: nombre,
                precio: precio,
                cantidad: 1
            });
        }

        actualizarCarritoDOM();
    }

    /** L√≥gica para QUITAR un producto individual */
    function quitarProducto(id) {
        const itemIndex = carrito.findIndex(item => item.id == id);

        if (itemIndex > -1) {
            // Reducir la cantidad
            carrito[itemIndex].cantidad -= 1;

            // Si la cantidad llega a 0, eliminar el producto completamente del array
            if (carrito[itemIndex].cantidad === 0) {
                carrito.splice(itemIndex, 1);
            }
        }
        
        actualizarCarritoDOM();
    }

    /** Asigna listeners al bot√≥n de Quitar espec√≠fico. */
    function asignarListenersQuitar() {
        // Seleccionamos los botones de quitar reci√©n insertados en el DOM
        document.querySelectorAll('.btn-quitar-item').forEach(button => {
            button.addEventListener('click', function() {
                const id = this.getAttribute('data-id');
                quitarProducto(id);
            });
        });
    }

    // ----------------------------------------------------
    // EVENT LISTENERS INICIALES (Al cargar la p√°gina)
    // ----------------------------------------------------

    // 1. Listeners para AGREGAR
    botonesAgregar.forEach(button => {
        button.addEventListener('click', function() {
            // Usamos los atributos 'data-' para obtener la informaci√≥n del producto
            const id = this.getAttribute('data-id');
            const nombre = this.getAttribute('data-nombre');
            const precio = parseFloat(this.getAttribute('data-precio'));
            
            agregarProducto(id, nombre, precio);
        });
    });

    // 2. Listener para VACIAR TODO el carrito
    btnVaciar.addEventListener('click', function() {
        if (confirm('¬øEst√°s seguro de que deseas vaciar todo el carrito?')) {
            carrito = []; // Resetear el array
            actualizarCarritoDOM();
        }
    });

    // Inicializar la interfaz al cargar la p√°gina (muestra 0.00‚Ç¨ y "carrito vac√≠o")
    actualizarCarritoDOM();
</script>
</body>
</html>